<html>

<head>
    <title>Eslzzyl's Image bed</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <link rel="shortcut icon" href="favicon.ico" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <div class="container">
        <h1>简易图床</h1>
        <a href="https://github.com/Eslzzyl/imagebed">
            https://github.com/Eslzzyl/imagebed
        </a>
        <div style="text-align: left;">
            <div>
                <h2>在线上传</h2>
                <form id="uploadForm" enctype="multipart/form-data">
                    <input type="file" id="fileInput" name="fileInput">
                    <br>
                    <button type="button" onclick="uploadFile()">上传</button>
                    <br>
                    <span id="filePrompt"></span>
                </form>
            </div>
            <div>
                <h2>通过脚本上传</h2>
                <p>向 UPLOAD 发 POST 请求，请求体携带你想上传的文件。你会在响应体中得到该文件的链接。</p>
                <p>文件不得大于 MAX_SIZE 。</p>
            </div>
            <div>
                <h2>状态</h2>
                <p>当前文件仓库总体积：TOTAL_SIZE</p>
                <p>当前文件总数：TOTAL_COUNT</p>
            </div>
        </div>
    </div>
</body>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    function uploadFile() {
        // 获取文件输入框
        const fileInput = document.getElementById('fileInput');
        // 获取提示标签
        const filePrompt = document.getElementById('filePrompt');
        filePrompt.innerHTML = "";
        // 获取文件
        const file = fileInput.files[0];

        // 检查是否选择了文件
        if (!file) {
            filePrompt.innerHTML = "请选择文件!";
            return;
        }

        // 创建 FormData 对象，用于将文件数据添加到 HTTP 请求中
        const formData = new FormData();
        formData.append('file', file);

        // 使用 Axios 发送 POST 请求
        axios.post('UPLOAD', formData)
            .then(response => {
                filePrompt.innerHTML = "文件上传成功，链接为：" + response.data;
                console.log('文件上传成功', response);
            })
            .catch(error => {
                filePrompt.innerHTML = "文件上传失败: " + error.message || "未知错误";
                console.error('文件上传失败', error);
            });
    }
</script>

</html>